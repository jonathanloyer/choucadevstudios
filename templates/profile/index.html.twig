{% extends 'layout.html.twig' %}

{# ========================
   SEO : titre + description + NOINDEX
   ======================== #}
{% block title %}
  Mon profil ‚Äî Espace client ChoucaDev Studios
{% endblock %}

{% block meta_description %}
  Espace priv√© de gestion du compte ChoucaDev Studios : consultez et mettez √† jour vos informations
  personnelles (email, coordonn√©es) en toute s√©curit√©.
{% endblock %}

{# On d√©sactive l‚Äôindexation SEO pour cette page priv√©e #}
{% block robots %}noindex,nofollow{% endblock %}

{% block body %}
<section class="max-w-3xl mx-auto px-4 py-10" aria-labelledby="profile-title">

  {# En-t√™te #}
  <header class="mb-6">
    <h1 id="profile-title" class="text-2xl font-semibold text-cyan-400">
      Bonjour {{ app.user.fullName ?: app.user.email }} üëã
    </h1>

    <p class="mt-2 text-sm text-slate-300">
      Consultez et mettez √† jour les informations de votre compte client ChoucaDev Studios.
    </p>
  </header>

  {# Messages flash #}
  {% for message in app.flashes('success') %}
    <div class="mb-4 p-3 rounded bg-green-700 text-green-100 text-sm" role="alert">
      {{ message }}
    </div>
  {% endfor %}

  {# Formulaire de profil #}
  <div class="bg-slate-900 border border-slate-800 rounded-xl p-6 shadow-lg space-y-4">
    {{ form_start(profileForm, {
      attr: {
        class: 'space-y-4',
        'aria-describedby': 'profile-description'
      }
    }) }}

      <p id="profile-description" class="sr-only">
        Formulaire de mise √† jour de vos informations personnelles (email, coordonn√©es).
      </p>

      {# Email #}
      <div class="space-y-2">
        {{ form_label(profileForm.email, 'Adresse email', {
          label_attr: { class: 'text-xs font-medium text-slate-300' }
        }) }}
        {{ form_widget(profileForm.email, {
          attr: {
            class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
          }
        }) }}
        <div class="text-xs text-red-300">
          {{ form_errors(profileForm.email) }}
        </div>
      </div>

      {# Pr√©nom #}
      {% if profileForm.firstname is defined %}
        <div class="space-y-2">
          {{ form_label(profileForm.firstname, 'Pr√©nom', {
            label_attr: { class: 'text-xs font-medium text-slate-300' }
          }) }}
          {{ form_widget(profileForm.firstname, {
            attr: {
              class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
            }
          }) }}
          <div class="text-xs text-red-300">
            {{ form_errors(profileForm.firstname) }}
          </div>
        </div>
      {% endif %}

      {# Nom #}
      {% if profileForm.lastname is defined %}
        <div class="space-y-2">
          {{ form_label(profileForm.lastname, 'Nom', {
            label_attr: { class: 'text-xs font-medium text-slate-300' }
          }) }}
          {{ form_widget(profileForm.lastname, {
            attr: {
              class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
            }
          }) }}
          <div class="text-xs text-red-300">
            {{ form_errors(profileForm.lastname) }}
          </div>
        </div>
      {% endif %}

      {# T√©l√©phone #}
      {% if profileForm.phone is defined %}
        <div class="space-y-2">
          {{ form_label(profileForm.phone, 'T√©l√©phone', {
            label_attr: { class: 'text-xs font-medium text-slate-300' }
          }) }}
          {{ form_widget(profileForm.phone, {
            attr: {
              class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
            }
          }) }}
          <div class="text-xs text-red-300">
            {{ form_errors(profileForm.phone) }}
          </div>
        </div>
      {% endif %}

      {# Adresse postale #}
      {% if profileForm.address is defined %}
        <div class="space-y-2">
          {{ form_label(profileForm.address, 'Adresse postale', {
            label_attr: { class: 'text-xs font-medium text-slate-300' }
          }) }}
          {{ form_widget(profileForm.address, {
            attr: {
              class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
            }
          }) }}
          <div class="text-xs text-red-300">
            {{ form_errors(profileForm.address) }}
          </div>
        </div>
      {% endif %}

      {# Code postal + ville #}
      <div class="grid gap-4 sm:grid-cols-2">
        {% if profileForm.postalCode is defined %}
          <div class="space-y-2">
            {{ form_label(profileForm.postalCode, 'Code postal', {
              label_attr: { class: 'text-xs font-medium text-slate-300' }
            }) }}
            {{ form_widget(profileForm.postalCode, {
              attr: {
                class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
              }
            }) }}
            <div class="text-xs text-red-300">
              {{ form_errors(profileForm.postalCode) }}
            </div>
          </div>
        {% endif %}

        {% if profileForm.city is defined %}
          <div class="space-y-2">
            {{ form_label(profileForm.city, 'Ville', {
              label_attr: { class: 'text-xs font-medium text-slate-300' }
            }) }}
            {{ form_widget(profileForm.city, {
              attr: {
                class: 'w-full px-3 py-2 bg-slate-950 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-1 focus:ring-cyan-400 focus:border-cyan-400'
              }
            }) }}
            <div class="text-xs text-red-300">
              {{ form_errors(profileForm.city) }}
            </div>
          </div>
        {% endif %}
      </div>

      <button type="submit"
              class="mt-4 px-4 py-2 bg-cyan-500 text-slate-950 text-sm font-semibold rounded-full hover:bg-cyan-400 transition"
              aria-label="Mettre √† jour votre profil">
        Mettre √† jour
      </button>

    {{ form_end(profileForm) }}
  </div>

  {# Lien tableau de bord #}
  <div class="mt-6 flex justify-end">
    <a href="{{ path('app_dashboard_redirect') }}"
       class="text-xs sm:text-sm text-cyan-300 hover:text-cyan-200 underline"
       aria-label="Acc√©der √† votre tableau de bord">
      Acc√©der √† mon tableau de bord
    </a>
  </div>

</section>
{% endblock %}
